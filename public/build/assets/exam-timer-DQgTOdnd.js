document.addEventListener("DOMContentLoaded",function(){const d=new Date(document.querySelector("[data-start-time]")?.getAttribute("data-start-time")||new Date),m=parseInt(document.querySelector("[data-duration]")?.getAttribute("data-duration")||0),r=d.getTime()+m*60*1e3,s=document.getElementById("timeRemaining");console.log("Start Time:",d),console.log("Duration:",m,"minutes"),console.log("End Time:",new Date(r)),console.log("Current Time:",new Date),console.log("Time remaining (ms):",r-new Date().getTime());function l(){const t=new Date().getTime(),e=r-t;if(e<0){console.log("Time expired!"),s.innerHTML="TIME'S UP!",s.parentElement.classList.add("text-danger"),clearInterval(b);const n=document.getElementById("submitExamForm");n&&n.submit();return}const o=Math.floor(e%(1e3*60*60)/(1e3*60)),u=Math.floor(e%(1e3*60)/1e3);s.innerHTML=`${o}:${u.toString().padStart(2,"0")}`,o<5&&s.parentElement.classList.add("text-warning")}l();const b=setInterval(l,1e3);let i=0;const c=document.querySelectorAll(".question-card"),h=c.length;function a(t){c.forEach((e,o)=>{e.style.display=o===t?"block":"none"}),i=t,document.querySelectorAll(".prev-btn").forEach(e=>{e.disabled=t===0})}document.querySelectorAll(".next-btn").forEach(t=>{t.addEventListener("click",function(){i<h-1&&a(i+1)})}),document.querySelectorAll(".prev-btn").forEach(t=>{t.addEventListener("click",function(){i>0&&a(i-1)})}),document.querySelectorAll(".question-nav-btn").forEach(t=>{t.addEventListener("click",function(){const e=parseInt(this.getAttribute("data-question"));a(e)})}),document.querySelectorAll('input[type="radio"]').forEach(t=>{t.addEventListener("change",function(){const e=this.getAttribute("data-question-id"),o=this.value,u=document.querySelector("[data-attempt-id]")?.getAttribute("data-attempt-id");fetch(`/student/attempts/${u}/answer`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({question_id:e,option_id:o})}).then(n=>n.json()).then(n=>{if(n.success){const g=document.getElementById("answeredCount"),E=document.getElementById("unansweredCount");g&&E&&(g.textContent=n.answered_count,E.textContent=n.unanswered_count);const y=document.querySelector(`[data-question="${Array.from(c).findIndex(p=>p.querySelector(`input[value="${o}"]`))}"]`);y&&y.classList.add("btn-success","text-white")}}).catch(n=>console.error("Error saving answer:",n))})});const f=document.getElementById("submitExamBtn");f&&f.addEventListener("click",function(){confirm("Are you sure you want to submit the exam? This action cannot be undone.")&&document.getElementById("submitExamForm").submit()})});
