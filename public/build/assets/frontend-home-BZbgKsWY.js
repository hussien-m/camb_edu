document.addEventListener("DOMContentLoaded",function(){const a=document.getElementById("contactForm"),s=document.getElementById("submitBtn"),t=document.getElementById("contactAlert"),n=document.getElementById("contactAlertMessage");a&&a.addEventListener("submit",async function(f){f.preventDefault(),s.disabled=!0,s.innerHTML='<i class="fas fa-spinner fa-spin me-2"></i> Verifying...',a.querySelectorAll(".is-invalid").forEach(e=>e.classList.remove("is-invalid")),a.querySelectorAll(".invalid-feedback").forEach(e=>e.textContent=""),t.style.display="none";let i=null;if(typeof executeRecaptcha=="function")try{i=await executeRecaptcha("contact_form"),s.innerHTML='<i class="fas fa-spinner fa-spin me-2"></i> Sending...'}catch{console.warn("reCAPTCHA not available, continuing without it")}const r=new FormData(a);i&&r.append("recaptcha_token",i),fetch(a.action,{method:"POST",body:r,headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(e=>e.ok?e.json():e.json().then(l=>{throw{status:e.status,data:l}})).then(e=>{e.success?(t.className="alert alert-success alert-dismissible fade show",n.textContent=e.message||"Your message has been sent successfully!",t.style.display="block",a.reset(),t.scrollIntoView({behavior:"smooth",block:"center"})):(t.className="alert alert-danger alert-dismissible fade show",n.textContent=e.message||"Something went wrong. Please try again.",t.style.display="block")}).catch(e=>{if(e.status===422&&e.data.errors){const l=e.data.errors;for(const d in l){const o=a.querySelector(`[name="${d}"]`);if(o){o.classList.add("is-invalid");const c=o.parentElement.querySelector(".invalid-feedback:last-child");c&&(c.textContent=l[d][0],c.style.display="block")}}t.className="alert alert-danger alert-dismissible fade show",n.textContent="Please fix the errors below.",t.style.display="block",t.scrollIntoView({behavior:"smooth",block:"center"})}else t.className="alert alert-danger alert-dismissible fade show",n.textContent="An error occurred. Please try again later.",t.style.display="block"}).finally(()=>{s.disabled=!1,s.innerHTML='<i class="fas fa-paper-plane me-2"></i> Send Message'})})});
